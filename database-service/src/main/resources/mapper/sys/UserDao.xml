<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.zr.modules.sys.dao.IUserDao">

    <sql id="userColumns">
        a.id,
        a.user_name,
        a.staff_name,
        a.office_id as "office.id",
        a.phone,
        a.password,
        a.site,
        a.create_by as "createBy.id",
        a.create_date,
        a.update_by as "updateBy.id",
        a.update_date,
        a.is_delete,
        a.remarks
    </sql>
    
    <sql id="userJoin">
        
    </sql>

    <resultMap type="com.zr.model.sys.User" id="userMap">
        <result property="id" column="id"/>
        <result property="userName" column="user_name"/>
        <result property="staffName" column="staff_name"/>
        <result property="office.id" column="office_id"/>
        <result property="phone" column="phone"/>
        <result property="password" column="password"/>
        <result property="site" column="site"/>
        <result property="createBy.id" column="create_by"/>
        <result property="createDate" column="create_date"/>
        <result property="updateBy.id" column="update_by"/>
        <result property="updateDate" column="update_date"/>
        <result property="isDelete" column="is_delete"/>
        <result property="remarks" column="remarks"/>
    </resultMap>

    <!--查询单条记录-->
    <select id="get" resultMap="userMap">
        select
        <include refid="userColumns"/>
        from sys_user a
        <include refid="userJoin"/>
        where a.id = #{id}
    </select>

    <!--查询列表-->
    <select id="findList" resultMap="userMap">
        select
        <include refid="userColumns"/>
        from sys_user a
        <include refid="userJoin"/>
        <where>
            <if test="id != null and id != ''">
                and id = #{id}
            </if>
            <if test="userName != null and userName != ''">
                and user_name = #{userName}
            </if>
            <if test="staffName != null and staffName != ''">
                and staff_name = #{staffName}
            </if>
            <if test="office != null and office.id != ''">
                and office_id = #{office.id}
            </if>
            <if test="phone != null and phone != ''">
                and phone = #{phone}
            </if>
            <if test="password != null and password != ''">
                and password = #{password}
            </if>
            <if test="site != null and site != ''">
                and site = #{site}
            </if>
            <if test="createBy != null and createBy.id != ''">
                and create_by = #{createBy.id}
            </if>
            <if test="createDate != null">
                and create_date = #{createDate}
            </if>
            <if test="updateBy != null and updateBy.id != ''">
                and update_by = #{updateBy.id}
            </if>
            <if test="updateDate != null">
                and update_date = #{updateDate}
            </if>
            <if test="isDelete != null">
                and is_delete = #{isDelete}
            </if>
            <if test="remarks != null and remarks != ''">
                and remarks = #{remarks}
            </if>
        </where>
        ORDER BY a.update_date
    </select>

    <!--新增所有列-->
    <insert id="insert">
        insert into fire_control.sys_user(id, user_name, staff_name, office_id, phone, password, site, create_by, create_date, update_by, update_date, is_delete, remarks)
        values (#{id}, #{userName}, #{staffName}, #{officeId}, #{phone}, #{password}, #{site}, #{createBy}, #{createDate}, #{updateBy}, #{updateDate}, #{isDelete}, #{remarks})
    </insert>

    <!--通过主键修改数据-->
    <update id="update">
        update fire_control.sys_user
        <set>
            <if test="userName != null and userName != ''">
                user_name = #{userName}
            </if>
            <if test="staffName != null and staffName != ''">
                staff_name = #{staffName}
            </if>
            <if test="office != null and office.id != ''">
                office_id = #{office.id}
            </if>
            <if test="phone != null and phone != ''">
                phone = #{phone}
            </if>
            <if test="password != null and password != ''">
                password = #{password}
            </if>
            <if test="site != null and site != ''">
                site = #{site}
            </if>
            <if test="updateBy != null and updateBy.id != ''">
                update_by = #{updateBy.id}
            </if>
            <if test="updateDate != null">
                update_date = #{updateDate}
            </if>
            <if test="remarks != null and remarks != ''">
                remarks = #{remarks}
            </if>
        </set>
        where id = #{id}
    </update>

    <!--通过主键逻辑删除-->
    <update id="delete">
        update fire_control.sys_user set is_delete = 1
    </update>

</mapper>