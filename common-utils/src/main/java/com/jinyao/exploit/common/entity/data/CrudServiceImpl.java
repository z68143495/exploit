package com.jinyao.exploit.common.entity.data;

import com.github.pagehelper.PageHelper;
import com.github.pagehelper.PageInfo;
import com.jinyao.exploit.common.entity.DataEntity;
import com.jinyao.exploit.common.entity.Page;
import org.springframework.beans.factory.annotation.Autowired;

import java.util.List;

/***********************************************************************
 * 文件说明：数据库基础service
 * 创建信息：李晋 2018-10-9 15:17
 * 变更履历： 
 ***********************************************************************/
public class CrudServiceImpl<D extends CrudDao<T>, T extends DataEntity> extends BaseService implements CrudService<T> {

  @Autowired
  protected D dao;

  @Override
  public T get(String id) {
    return dao.get(id);
  }

  @Override
  public T get(T t) {
    return dao.get(t);
  }

  @Override
  public List<T> findList(T t) {
    return dao.findList(t);
  }

  @Override
  public Page<T> findPage(Page<T> page, T t) {
    PageHelper.startPage(page.getPageNo(), page.getPageSize());
    List<T> list = dao.findList(t);
    PageInfo pageinfo = new PageInfo(list);
    page.setCount(pageinfo.getTotal());
    page.setList(list);
    return page;
  }

  @Override
  public List<T> findAllList() {
    return dao.findAllList();
  }

  public void insert(T t) {
    dao.insert(t);
  }

  public void update(T t) {
    dao.update(t);
  }

  public void save(T t){
    if(t.isNewRecord()){
      t.preInsert();
      insert(t);
    }else {
      t.preUpdate();
      update(t);
    }
  }

  @Override
  public void delete(String id) {
    dao.delete(id);
  }

  @Override
  public void delete(T t) {
    dao.delete(t);
  }

  @Override
  public void batchDelete(List<String> idList) {
    dao.batchDelete(idList);
  }
}
