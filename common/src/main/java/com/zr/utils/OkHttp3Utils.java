package com.zr.utils;

import okhttp3.*;

import java.io.IOException;

/**
 * Created by Administrator on 2017/2/9.
 */
public class OkHttp3Utils {
    /**
     * 向指定 URL 发送POST方法的请求
     *
     * @param url         发送请求的 URL
     * @param param       请求参数，json格式
     * @param method      请求类型 （post, get）
     * @return 所代表远程资源的响应结果
     */
    public static final MediaType JSON = MediaType.parse("application/json; charset=utf-8");
    public static String sendRequest(String url, String param, String method) throws IOException {
        Request request;
        // 发送post
        if("post".equals(method.toLowerCase())){
            RequestBody requestBody = RequestBody.create(JSON, param);
            request = new Request.Builder().url(url).post(requestBody).build();
        }else{
            // 发送get
            request = new Request.Builder().url(url).build();
        }
        // 响应
        Response response = new OkHttpClient().newCall(request).execute();
        if (response.isSuccessful()) {
            return response.body().string();
        } else {
            throw new IOException("Unexpected code " + response);
        }
    }
}
